<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
  <head th:replace="~{fragmentos :: imports-css(title='Funcionários')}">
    <title>title</title>
  </head>
  <body>
    <div th:replace="~{fragmentos :: barramenu(pagina='funcionarios')}" />
    <div class="container" style="margin-top: 20px; width: 60%">
      <div class="card-header">
        <h4>
          Cadastro de Funcionários
          <a class="btn btn-primary float-right" th:href="@{~/funcionarios}" role="button">Voltar</a>
        </h4>
      </div>
      <div th:replace="~{fragmentos :: mensagens}"></div>

      <form
        th:object="${funcionario}"
        th:action="@{~/funcionarios/funcionario/{id}(id=${funcionario.id})}"
        method="post"
        class="card-body"
      >
        <input type="hidden" th:field="*{id}" />
        <div class="form-row">
          <div class="form-group col">
            <label for="nome">Nome:</label>
            <input
              th:field="*{nome}"
              type="text"
              class="form-control"
              id="nome"
              placeholder="Nome"
              required="required"
              maxlength="150"
            />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group col">
            <label for="email">E-mail:</label>
            <input
              th:field="*{email}"
              type="email"
              class="form-control"
              placeholder="Email"
              maxlength="100"
              required="required"
            />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group col-md-9">
            <label for="senha">Senha:</label>
            <input
              th:field="*{senha}"
              type="password"
              class="form-control"
              placeholder="Senha"
              maxlength="50"
              required="required"
            />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group col-md-6">
            <label for="cpf">CPF:</label>
            <input th:field="*{cpf}" type="text" class="form-control" placeholder="CPF" required="required" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group col-md-5">
            <label for="telefone">Telefone:</label>
            <input
              th:field="*{telefone}"
              type="number"
              class="form-control"
              placeholder="telefone"
              required="required"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group col">
            <label>Permissões:</label>
          </div>
        </div>
        <div class="form-row">
          <div class="form-check form-check-inline" th:each="permissao,i : ${permissoes}">
            <input
              class="form-check-input"
              type="checkbox"
              th:name="${'permissoes['+i.index+'].id'}"
              th:value="${permissao.id}"
              th:checked="${#lists.contains(funcionario.permissoes, permissao)? 'checked' : false}"
            />
            <label class="form-check-label" th:text="${permissao.nome}">t</label>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group col-md-9">
            <label for="endereco.rua">Rua:</label>
            <input
              th:field="*{endereco.rua}"
              maxlength="200"
              type="text"
              class="form-control"
              placeholder="Rua"
              required="required"
            />
          </div>
          <div class="form-group col-md-3">
            <label for="endereco.numero">Número:</label>
            <input
              th:field="*{endereco.numero}"
              type="number"
              min="0"
              max="9999"
              class="form-control"
              placeholder="Número"
            />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group col-md-5">
            <label for="endereco.bairro">Bairro:</label>
            <input
              th:field="*{endereco.bairro}"
              type="text"
              maxlength="50"
              class="form-control"
              placeholder="Bairro"
              required="required"
            />
          </div>
          <div class="form-group col-md-5">
            <label for="endereco.cidade">Cidade:</label>
            <input
              th:field="*{endereco.cidade}"
              type="text"
              maxlength="50"
              class="form-control"
              placeholder="Cidade"
              required="required"
            />
          </div>
          <div class="form-group col-md-2">
            <label for="endereco.cep">CEP:</label>
            <input
              th:field="*{endereco.cep}"
              type="text"
              maxlength="9"
              pattern="[0-9]{5}-[0-9]{3}"
              class="form-control"
              placeholder="CEP"
              required="required"
            />
          </div>
        </div>

        <div class="card-footer">
          <input type="submit" class="btn btn-success" value="SALVAR" />
        </div>
      </form>
    </div>

    <div th:replace="~{fragmentos :: imports-js}" />

    <script>
      $(document).ready(function () {
        $("#addTel").on("click", function () {
          var count = 0;
          $("#camposTelefones")
            .find("input")
            .each(function (index, element) {
              count++;
            });
          var str =
            '<div id="telefones' +
            count +
            '" class="form-group col-md-3"><input name="telefones[' +
            count +
            '].numero" type="tel" maxlength="14" pattern="\\([0-9]{2}\\)[0-9]{4,5}-[0-9]{4}" class="form-control" placeholder="(00)00000-0000" required="required"/></div>';
          $("#camposTelefones").append(str);
        });
        $("#delTel").on("click", function () {
          var e = $("#camposTelefones").find("div").last();
          e.remove();
        });
      });
    </script>
  </body>
</html>
